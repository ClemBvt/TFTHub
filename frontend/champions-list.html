<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des Champions - TFT Hub</title>
    <link rel="stylesheet" href="/styles/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <nav class="site-nav">
        <div class="nav-wrap">
            <a class="logo" href="index.html">TFT Hub</a>
            <div class="nav-links">
                <a href="champions-list.html">Voir les champions</a>
                <a href="create.html" class="btn">Créer un champion</a>
            </div>
        </div>
    </nav>

    <div class="wrap">
        <header style="margin-bottom: 32px;">
            <div>
                <h1>Liste des Champions</h1>
                <p>Explorez tous les champions disponibles et consultez leurs détails</p>
            </div>
        </header>

        <div id="loadingMessage" style="text-align: center; color: #9fb0d6; font-size: 16px;">
            <i class="fas fa-spinner fa-spin" style="margin-right: 8px;"></i>
            Chargement des champions...
        </div>

        <div id="championsGrid" class="champions-grid"></div>

        <div id="errorMessage" style="display: none; background: #dc2626; color: white; padding: 16px; border-radius: 8px; margin-top: 16px;">
            Erreur lors du chargement des champions. Veuillez rafraîchir la page.
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:3000/champions';
        const championsGrid = document.getElementById('championsGrid');
        const loadingMessage = document.getElementById('loadingMessage');
        const errorMessage = document.getElementById('errorMessage');

        async function loadChampions() {
            try {
                const response = await fetch(API_BASE_URL);
                
                if (!response.ok) {
                    throw new Error('Erreur lors du chargement des champions');
                }

                const champions = await response.json();
                
                if (champions.length === 0) {
                    championsGrid.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; color: #9fb0d6; padding: 40px;">Aucun champion trouvé. <a href="create.html" style="color: #0ea5a4; text-decoration: none;">Créez-en un!</a></p>';
                } else {
                    championsGrid.innerHTML = '';
                    champions.forEach(champion => {
                        const card = createChampionCard(champion);
                        championsGrid.appendChild(card);
                    });
                }

                loadingMessage.style.display = 'none';
            } catch (error) {
                console.error('Erreur:', error);
                loadingMessage.style.display = 'none';
                errorMessage.style.display = 'block';
            }
        }

        function createChampionCard(champion) {
            const card = document.createElement('div');
            card.className = 'champion-card';
            card.style.cursor = 'pointer';

            const costBadge = `<span class="cost-badge">${champion.cost}★</span>`;
            const classNames = champion.class && champion.class.length > 0 
                ? champion.class.join(', ') 
                : 'N/A';

            card.innerHTML = `
                <div class="champion-card-portrait">${champion.name.charAt(0).toUpperCase()}</div>
                <div class="champion-card-content">
                    <div class="champion-card-header">
                        <h3>${champion.name}</h3>
                        ${costBadge}
                    </div>
                    <div class="champion-card-stats">
                        <div class="stat-mini">
                            <span class="stat-label">Santé</span>
                            <span class="stat-value">${champion.health || '—'}</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-label">Dégâts</span>
                            <span class="stat-value">${champion.damage || '—'}</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-label">Armure</span>
                            <span class="stat-value">${champion.armor || '—'}</span>
                        </div>
                        <div class="stat-mini">
                            <span class="stat-label">DPS</span>
                            <span class="stat-value">${champion.dps || '—'}</span>
                        </div>
                    </div>
                    <div class="champion-card-footer">
                        <span class="view-details">Voir les détails →</span>
                    </div>
                </div>
            `;

            card.addEventListener('click', () => {
                window.location.href = `champions.html?id=${champion._id}`;
            });

            return card;
        }

        // Load champions on page load
        loadChampions();
    </script>
</body>
</html>
