<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer un champion - TFT Hub</title>
    <link rel="stylesheet" href="/styles/style.css">
</head>
<body>
    <nav class="site-nav">
        <div class="nav-wrap">
            <a class="logo" href="champions.html">TFT Hub</a>
            <div class="nav-links">
                <a href="champions.html">Voir les champions</a>
                <a href="create.html" class="btn">Créer un champion</a>
            </div>
        </div>
    </nav>

    <div class="create-container">
        <div class="create-header">
            <h2>Créer un nouveau champion</h2>
            <a href="champions.html" class="back-btn">← Retour</a>
        </div>

        <div class="form-card">
            <form id="createChampionForm">
                <div class="form-group">
                    <label for="name">Nom du champion *</label>
                    <input type="text" id="name" name="name" placeholder="Ex: Ashe" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cost">Coût *</label>
                        <input type="number" id="cost" name="cost" placeholder="Ex: 1" min="1" max="5" required>
                    </div>
                    <div class="form-group">
                        <label for="health">Santé *</label>
                        <input type="number" id="health" name="health" placeholder="Ex: 650" min="0" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="mana">Mana *</label>
                        <input type="number" id="mana" name="mana" placeholder="Ex: 50" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="armor">Armure *</label>
                        <input type="number" id="armor" name="armor" placeholder="Ex: 20" min="0" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="dps">DPS *</label>
                        <input type="number" id="dps" name="dps" placeholder="Ex: 50" min="0" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="attackSpeed">Vitesse d'attaque *</label>
                        <input type="number" id="attackSpeed" name="attackSpeed" placeholder="Ex: 0.75" min="0" step="0.01" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="magicResist">Résistance Magique *</label>
                        <input type="number" id="magicResist" name="magicResist" placeholder="Ex: 20" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="damage">Dégâts *</label>
                        <input type="number" id="damage" name="damage" placeholder="Ex: 50" min="0" step="0.1" required>
                    </div>
                </div>

                <!-- <div class="form-group">
                    <label for="class">IDs des classes (séparés par des virgules) *</label>
                    <input type="text" id="class" name="class" placeholder="Ex: 507f1f77bcf86cd799439011, 507f1f77bcf86cd799439012" required>
                </div> -->

                <div class="form-actions">
                    <button type="submit" class="btn-submit">Créer le champion</button>
                    <button type="button" class="btn-cancel" onclick="window.location.href='champions.html'">Annuler</button>
                </div>
            </form>
        </div>
    </div>
    <script>
        const API_BASE_URL = 'http://localhost:3000/champions';
        const form = document.getElementById('createChampionForm');

        function showToast(message, type = "success") {
        const container = document.getElementById("toastContainer");
        const toast = document.createElement("div");

        toast.className = "toast";
        if (type === "error") toast.classList.add("error");

        toast.textContent = message;
        container.appendChild(toast);

        setTimeout(() => {
            toast.remove();
        }, 5000);
    }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const data = {
                name: String(document.getElementById('name').value),
                cost: Number(document.getElementById('cost').value),
                health: Number(document.getElementById('health').value),
                mana: Number(document.getElementById('mana').value),
                dps: Number(document.getElementById('dps').value),
                attackSpeed: Number(document.getElementById('attackSpeed').value),
                armor: Number(document.getElementById('armor').value),
                magicResist: Number(document.getElementById('magicResist').value),
                damage: Number(document.getElementById('damage').value)
            };

            try {
                const response = await fetch(API_BASE_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (response.ok) {
                    showToast('Champion créé avec succès !', 'success');
                    setTimeout(() => {
                        window.location.href = 'champions-list.html';
                    }, 1000);
                } else {
                    showToast('Erreur : ' + (result.error || 'Impossible de créer le champion.'), 'error');
                }
            } catch (error) {
                console.error('Erreur création champion :', error);
                showToast('Erreur lors de la communication avec le serveur.', 'error');
            }
        });
    </script>
</body>
</html>
